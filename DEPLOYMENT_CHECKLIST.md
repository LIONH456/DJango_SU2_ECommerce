# üöÄ Pre-Deployment Checklist

## ‚úÖ Completed Tasks

### 1. Database Setup
- [x] MongoDB Atlas cluster created
- [x] Local data copied to Atlas cluster
- [x] MongoDB connection string obtained
- [x] MongoDB utils updated to use Atlas in production

### 2. Code Updates
- [x] Settings.py updated for production
- [x] MongoDB configuration supports Atlas URI
- [x] Requirements.txt updated with latest dependencies
- [x] Build script created (build.sh)
- [x] Render.yaml configured

### 3. Static Files
- [x] Static files collected successfully
- [x] WhiteNoise configured for static file serving
- [x] STATIC_ROOT and STATICFILES_DIRS configured

### 4. Security
- [x] DEBUG set to False in production
- [x] Security headers configured
- [x] HTTPS redirect enabled
- [x] Secret key will be auto-generated by Render

## üîÑ Next Steps for Deployment

### 1. Push to GitHub
```bash
git add .
git commit -m "Prepare for Render.com deployment with MongoDB Atlas"
git push origin main
```

### 2. Deploy on Render.com

#### Option A: Using Blueprint (Recommended)
1. Go to [Render.com](https://render.com)
2. Click "New +" ‚Üí "Blueprint"
3. Connect your GitHub repository
4. Render will automatically detect `render.yaml`
5. Click "Apply"

#### Option B: Manual Setup
1. Go to [Render.com](https://render.com)
2. Click "New +" ‚Üí "Web Service"
3. Connect your GitHub repository
4. Configure:
   - **Name**: `ecommerce-django`
   - **Environment**: `Python`
   - **Build Command**: `./build.sh`
   - **Start Command**: `gunicorn ECommerce.wsgi:application`

### 3. Environment Variables to Set in Render

#### Required Variables:
```
SECRET_KEY=your-secret-key-here
DEBUG=false
ALLOWED_HOSTS=.onrender.com
```

#### MongoDB Atlas Variables:
```
MONGODB_ATLAS_URI=mongodb+srv://lionh456:LVixKN2699pd2wpO@ecommercesu2.xcvh6ig.mongodb.net/?retryWrites=true&w=majority&appName=EcommerceSU2
MONGODB_DATABASE=EcommerceSU2
MONGODB_COLLECTION=users
```

### 4. Post-Deployment Tasks

#### Create Superuser:
```bash
# In Render shell or locally with production settings
python manage.py createsuperuser
```

#### Test Features:
- [ ] Homepage loads correctly
- [ ] Admin dashboard accessible at `/ecadmin/`
- [ ] User registration works
- [ ] User login works
- [ ] Static files (CSS/JS) load properly
- [ ] MongoDB connection works

## üßπ Clean Up (After Deployment)

### Files to Remove:
- [ ] `copy_to_atlas.py`
- [ ] `copy_to_atlas_simple.py`
- [ ] `test_production.py`
- [ ] `check_local_data.py`

### Commands:
```bash
# Remove temporary files
rm copy_to_atlas.py
rm copy_to_atlas_simple.py
rm test_production.py
rm check_local_data.py

# Commit cleanup
git add .
git commit -m "Clean up deployment files"
git push origin main
```

## üîç Troubleshooting

### Common Issues:

1. **Build Fails:**
   - Check `requirements.txt` has all dependencies
   - Verify `build.sh` is executable
   - Check Python version compatibility

2. **MongoDB Connection Error:**
   - Verify `MONGODB_ATLAS_URI` environment variable
   - Check MongoDB Atlas network access (allow 0.0.0.0/0)
   - Verify database and collection names

3. **Static Files Not Loading:**
   - Ensure `collectstatic` runs in build
   - Check `STATIC_ROOT` setting
   - Verify WhiteNoise configuration

4. **Authentication Issues:**
   - Check `AUTH_USER_MODEL` setting
   - Verify `AUTHENTICATION_BACKENDS` configuration
   - Test MongoDB user creation

### Useful Commands:

```bash
# Test locally with production settings
python test_production.py

# Check environment variables
python manage.py shell -c "from django.conf import settings; print(settings.DEBUG)"

# Test MongoDB connection
python manage.py shell -c "from main.mongodb_utils import mongodb_manager; print(mongodb_manager.client.admin.command('ping'))"
```

## üìû Support

If you encounter issues:
1. Check Render logs for error messages
2. Verify all environment variables are set correctly
3. Test MongoDB connection locally with Atlas
4. Check Django settings for production configuration

---

**Your app will be available at:** `https://your-app-name.onrender.com`

**Admin Dashboard:** `https://your-app-name.onrender.com/ecadmin/`
